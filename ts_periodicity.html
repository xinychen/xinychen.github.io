<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Series Periodicity</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
        }
        .chart-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .time-series-container {
            position: relative;
            height: 220px;
            width: 100%;
            margin-bottom: 30px;
        }
        .scatter-container {
            position: relative;
            height: 400px;
            width: 32%;
            margin-bottom: 20px;
        }
        .controls {
            margin: 10px 0;
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        button {
            padding: 8px 16px;
            background-color: rgb(202, 209, 202);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .info {
            margin: 15px 0;
            padding: 8px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .lag-control {
            margin: 10px 0;
            text-align: center;
        }
        .lag-control input {
            width: 60px;
            text-align: center;
        }
    </style>
</head>

<body>
    <!-- <h1>Time Series and Lag Scatter Plots</h1> -->
    
    <!-- <div class="info">
        <p>This visualization shows the time series in the top chart and scatter plots of the time series against lagged versions of itself below. Use the controls to adjust the zoom and lag values.</p>
    </div> -->
    <div class="info">
        <p>This is an interactive visualization tool for showing time series periodicity of Chicago ridesharing trips over two weeks (starting April 1, 2024). 
            <!-- <b>Please open it with your laptop for an interactive visualization.</b>  -->
            For a reference, please check out <a href="https://doi.org/10.1109/TKDE.2025.3550877">Chen et al., 2025</a>.</p>
    </div>

    <!-- First row: Time series chart -->
    <div class="time-series-container">
      <!-- <div class="controls">
        <button id="zoomIn">Zoom In</button>
        <button id="zoomOut">Zoom Out</button>
        <button id="panLeft">Pan Left</button>
        <button id="panRight">Pan Right</button>
        <button id="resetZoom">Reset Zoom</button>
    </div> -->
    <canvas id="timeSeriesChart"></canvas>
    </div>

    <!-- Second row: Three scatter plots -->
    <div class="chart-row">
        <!-- First scatter plot -->
        <div class="scatter-container">
            <canvas id="scatterChart1"></canvas>
            <div class="lag-control">
                <label for="lag1">Lag (\(k\)):</label>
                <input type="number" id="lag1" min="1" max="360" value="1">
                <button onclick="updateChart(1)">Update</button>
            </div>
        </div>
        
        <!-- Second scatter plot -->
        <div class="scatter-container">
            <canvas id="scatterChart2"></canvas>
            <div class="lag-control">
                <label for="lag2">Lag (\(k\)):</label>
                <input type="number" id="lag2" min="1" max="360" value="24">
                <button onclick="updateChart(2)">Update</button>
            </div>
        </div>
        
        <!-- Third scatter plot -->
        <div class="scatter-container">
            <canvas id="scatterChart3"></canvas>
            <div class="lag-control">
                <label for="lag3">Lag (\(k\)):</label>
                <input type="number" id="lag3" min="1" max="360" value="168">
                <button onclick="updateChart(3)">Update</button>
            </div>
        </div>
    </div>

    <script>
        // Time series data
        const timeSeriesData = [
            [1.000000000000000000e+00, 3.766000000000000000e+03],
            [2.000000000000000000e+00, 2.162000000000000000e+03],
            [3.000000000000000000e+00, 1.432000000000000000e+03],
            [4.000000000000000000e+00, 1.220000000000000000e+03],
            [5.000000000000000000e+00, 1.656000000000000000e+03],
            [6.000000000000000000e+00, 2.884000000000000000e+03],
            [7.000000000000000000e+00, 4.827000000000000000e+03],
            [8.000000000000000000e+00, 7.350000000000000000e+03],
            [9.000000000000000000e+00, 9.210000000000000000e+03],
            [1.000000000000000000e+01, 9.112000000000000000e+03],
            [1.100000000000000000e+01, 8.316000000000000000e+03],
            [1.200000000000000000e+01, 8.208000000000000000e+03],
            [1.300000000000000000e+01, 8.728000000000000000e+03],
            [1.400000000000000000e+01, 8.583000000000000000e+03],
            [1.500000000000000000e+01, 8.325000000000000000e+03],
            [1.600000000000000000e+01, 1.017500000000000000e+04],
            [1.700000000000000000e+01, 1.077600000000000000e+04],
            [1.800000000000000000e+01, 1.231800000000000000e+04],
            [1.900000000000000000e+01, 1.114500000000000000e+04],
            [2.000000000000000000e+01, 9.984000000000000000e+03],
            [2.100000000000000000e+01, 9.041000000000000000e+03],
            [2.200000000000000000e+01, 7.868000000000000000e+03],
            [2.300000000000000000e+01, 6.927000000000000000e+03],
            [2.400000000000000000e+01, 4.880000000000000000e+03],
            [2.500000000000000000e+01, 3.041000000000000000e+03],
            [2.600000000000000000e+01, 1.741000000000000000e+03],
            [2.700000000000000000e+01, 1.174000000000000000e+03],
            [2.800000000000000000e+01, 9.780000000000000000e+02],
            [2.900000000000000000e+01, 1.550000000000000000e+03],
            [3.000000000000000000e+01, 2.845000000000000000e+03],
            [3.100000000000000000e+01, 5.229000000000000000e+03],
            [3.200000000000000000e+01, 8.530000000000000000e+03],
            [3.300000000000000000e+01, 1.177200000000000000e+04],
            [3.400000000000000000e+01, 1.127100000000000000e+04],
            [3.500000000000000000e+01, 9.237000000000000000e+03],
            [3.600000000000000000e+01, 8.712000000000000000e+03],
            [3.700000000000000000e+01, 8.850000000000000000e+03],
            [3.800000000000000000e+01, 9.449000000000000000e+03],
            [3.900000000000000000e+01, 9.940000000000000000e+03],
            [4.000000000000000000e+01, 1.075300000000000000e+04],
            [4.100000000000000000e+01, 1.015100000000000000e+04],
            [4.200000000000000000e+01, 1.155900000000000000e+04],
            [4.300000000000000000e+01, 1.173500000000000000e+04],
            [4.400000000000000000e+01, 1.010000000000000000e+04],
            [4.500000000000000000e+01, 9.031000000000000000e+03],
            [4.600000000000000000e+01, 9.051000000000000000e+03],
            [4.700000000000000000e+01, 7.541000000000000000e+03],
            [4.800000000000000000e+01, 5.105000000000000000e+03],
            [4.900000000000000000e+01, 3.066000000000000000e+03],
            [5.000000000000000000e+01, 1.862000000000000000e+03],
            [5.100000000000000000e+01, 1.239000000000000000e+03],
            [5.200000000000000000e+01, 1.062000000000000000e+03],
            [5.300000000000000000e+01, 1.545000000000000000e+03],
            [5.400000000000000000e+01, 2.972000000000000000e+03],
            [5.500000000000000000e+01, 5.444000000000000000e+03],
            [5.600000000000000000e+01, 9.171000000000000000e+03],
            [5.700000000000000000e+01, 1.225800000000000000e+04],
            [5.800000000000000000e+01, 1.188400000000000000e+04],
            [5.900000000000000000e+01, 9.569000000000000000e+03],
            [6.000000000000000000e+01, 8.472000000000000000e+03],
            [6.100000000000000000e+01, 9.805000000000000000e+03],
            [6.200000000000000000e+01, 1.025600000000000000e+04],
            [6.300000000000000000e+01, 1.034200000000000000e+04],
            [6.400000000000000000e+01, 1.192000000000000000e+04],
            [6.500000000000000000e+01, 1.227800000000000000e+04],
            [6.600000000000000000e+01, 1.342700000000000000e+04],
            [6.700000000000000000e+01, 1.353300000000000000e+04],
            [6.800000000000000000e+01, 1.214300000000000000e+04],
            [6.900000000000000000e+01, 1.067500000000000000e+04],
            [7.000000000000000000e+01, 9.930000000000000000e+03],
            [7.100000000000000000e+01, 8.905000000000000000e+03],
            [7.200000000000000000e+01, 6.097000000000000000e+03],
            [7.300000000000000000e+01, 3.603000000000000000e+03],
            [7.400000000000000000e+01, 2.088000000000000000e+03],
            [7.500000000000000000e+01, 1.424000000000000000e+03],
            [7.600000000000000000e+01, 1.251000000000000000e+03],
            [7.700000000000000000e+01, 1.844000000000000000e+03],
            [7.800000000000000000e+01, 3.219000000000000000e+03],
            [7.900000000000000000e+01, 5.483000000000000000e+03],
            [8.000000000000000000e+01, 9.111000000000000000e+03],
            [8.100000000000000000e+01, 1.248800000000000000e+04],
            [8.200000000000000000e+01, 1.208800000000000000e+04],
            [8.300000000000000000e+01, 1.003000000000000000e+04],
            [8.400000000000000000e+01, 1.002200000000000000e+04],
            [8.500000000000000000e+01, 1.016600000000000000e+04],
            [8.600000000000000000e+01, 1.026300000000000000e+04],
            [8.700000000000000000e+01, 1.049100000000000000e+04],
            [8.800000000000000000e+01, 1.132000000000000000e+04],
            [8.900000000000000000e+01, 1.199600000000000000e+04],
            [9.000000000000000000e+01, 1.358000000000000000e+04],
            [9.100000000000000000e+01, 1.427100000000000000e+04],
            [9.200000000000000000e+01, 1.339100000000000000e+04],
            [9.300000000000000000e+01, 1.162400000000000000e+04],
            [9.400000000000000000e+01, 1.135400000000000000e+04],
            [9.500000000000000000e+01, 1.111300000000000000e+04],
            [9.600000000000000000e+01, 8.032000000000000000e+03],
            [9.700000000000000000e+01, 5.144000000000000000e+03],
            [9.800000000000000000e+01, 3.336000000000000000e+03],
            [9.900000000000000000e+01, 2.162000000000000000e+03],
            [1.000000000000000000e+02, 1.547000000000000000e+03],
            [1.010000000000000000e+02, 2.076000000000000000e+03],
            [1.020000000000000000e+02, 3.320000000000000000e+03],
            [1.030000000000000000e+02, 5.459000000000000000e+03],
            [1.040000000000000000e+02, 8.339000000000000000e+03],
            [1.050000000000000000e+02, 1.127900000000000000e+04],
            [1.060000000000000000e+02, 1.084300000000000000e+04],
            [1.070000000000000000e+02, 9.832000000000000000e+03],
            [1.080000000000000000e+02, 9.748000000000000000e+03],
            [1.090000000000000000e+02, 1.019600000000000000e+04],
            [1.100000000000000000e+02, 1.066100000000000000e+04],
            [1.110000000000000000e+02, 1.086600000000000000e+04],
            [1.120000000000000000e+02, 1.180700000000000000e+04],
            [1.130000000000000000e+02, 1.238600000000000000e+04],
            [1.140000000000000000e+02, 1.504000000000000000e+04],
            [1.150000000000000000e+02, 1.673500000000000000e+04],
            [1.160000000000000000e+02, 1.752900000000000000e+04],
            [1.170000000000000000e+02, 1.629900000000000000e+04],
            [1.180000000000000000e+02, 1.538200000000000000e+04],
            [1.190000000000000000e+02, 1.638800000000000000e+04],
            [1.200000000000000000e+02, 1.599700000000000000e+04],
            [1.210000000000000000e+02, 1.225000000000000000e+04],
            [1.220000000000000000e+02, 9.682000000000000000e+03],
            [1.230000000000000000e+02, 6.553000000000000000e+03],
            [1.240000000000000000e+02, 3.926000000000000000e+03],
            [1.250000000000000000e+02, 2.794000000000000000e+03],
            [1.260000000000000000e+02, 2.706000000000000000e+03],
            [1.270000000000000000e+02, 4.149000000000000000e+03],
            [1.280000000000000000e+02, 4.762000000000000000e+03],
            [1.290000000000000000e+02, 6.196000000000000000e+03],
            [1.300000000000000000e+02, 7.885000000000000000e+03],
            [1.310000000000000000e+02, 9.587000000000000000e+03],
            [1.320000000000000000e+02, 1.064800000000000000e+04],
            [1.330000000000000000e+02, 1.169100000000000000e+04],
            [1.340000000000000000e+02, 1.199800000000000000e+04],
            [1.350000000000000000e+02, 1.267200000000000000e+04],
            [1.360000000000000000e+02, 1.299200000000000000e+04],
            [1.370000000000000000e+02, 1.396800000000000000e+04],
            [1.380000000000000000e+02, 1.585500000000000000e+04],
            [1.390000000000000000e+02, 1.661100000000000000e+04],
            [1.400000000000000000e+02, 1.764500000000000000e+04],
            [1.410000000000000000e+02, 1.756300000000000000e+04],
            [1.420000000000000000e+02, 1.698000000000000000e+04],
            [1.430000000000000000e+02, 1.849200000000000000e+04],
            [1.440000000000000000e+02, 1.718100000000000000e+04],
            [1.450000000000000000e+02, 1.493800000000000000e+04],
            [1.460000000000000000e+02, 1.146000000000000000e+04],
            [1.470000000000000000e+02, 8.356000000000000000e+03],
            [1.480000000000000000e+02, 5.132000000000000000e+03],
            [1.490000000000000000e+02, 3.463000000000000000e+03],
            [1.500000000000000000e+02, 3.129000000000000000e+03],
            [1.510000000000000000e+02, 3.565000000000000000e+03],
            [1.520000000000000000e+02, 4.031000000000000000e+03],
            [1.530000000000000000e+02, 4.741000000000000000e+03],
            [1.540000000000000000e+02, 6.365000000000000000e+03],
            [1.550000000000000000e+02, 8.316000000000000000e+03],
            [1.560000000000000000e+02, 9.600000000000000000e+03],
            [1.570000000000000000e+02, 1.043900000000000000e+04],
            [1.580000000000000000e+02, 1.048100000000000000e+04],
            [1.590000000000000000e+02, 1.210300000000000000e+04],
            [1.600000000000000000e+02, 1.192100000000000000e+04],
            [1.610000000000000000e+02, 1.143500000000000000e+04],
            [1.620000000000000000e+02, 1.010200000000000000e+04],
            [1.630000000000000000e+02, 8.777000000000000000e+03],
            [1.640000000000000000e+02, 8.363000000000000000e+03],
            [1.650000000000000000e+02, 8.256000000000000000e+03],
            [1.660000000000000000e+02, 7.386000000000000000e+03],
            [1.670000000000000000e+02, 6.626000000000000000e+03],
            [1.680000000000000000e+02, 5.088000000000000000e+03],
            [1.690000000000000000e+02, 3.324000000000000000e+03],
            [1.700000000000000000e+02, 1.911000000000000000e+03],
            [1.710000000000000000e+02, 1.361000000000000000e+03],
            [1.720000000000000000e+02, 1.225000000000000000e+03],
            [1.730000000000000000e+02, 1.744000000000000000e+03],
            [1.740000000000000000e+02, 3.107000000000000000e+03],
            [1.750000000000000000e+02, 4.948000000000000000e+03],
            [1.760000000000000000e+02, 7.582000000000000000e+03],
            [1.770000000000000000e+02, 9.966000000000000000e+03],
            [1.780000000000000000e+02, 9.157000000000000000e+03],
            [1.790000000000000000e+02, 7.842000000000000000e+03],
            [1.800000000000000000e+02, 7.699000000000000000e+03],
            [1.810000000000000000e+02, 8.210000000000000000e+03],
            [1.820000000000000000e+02, 8.518000000000000000e+03],
            [1.830000000000000000e+02, 8.125000000000000000e+03],
            [1.840000000000000000e+02, 8.768000000000000000e+03],
            [1.850000000000000000e+02, 9.023000000000000000e+03],
            [1.860000000000000000e+02, 9.293000000000000000e+03],
            [1.870000000000000000e+02, 9.338000000000000000e+03],
            [1.880000000000000000e+02, 8.803000000000000000e+03],
            [1.890000000000000000e+02, 8.457000000000000000e+03],
            [1.900000000000000000e+02, 7.536000000000000000e+03],
            [1.910000000000000000e+02, 7.221000000000000000e+03],
            [1.920000000000000000e+02, 5.473000000000000000e+03],
            [1.930000000000000000e+02, 3.343000000000000000e+03],
            [1.940000000000000000e+02, 1.814000000000000000e+03],
            [1.950000000000000000e+02, 1.236000000000000000e+03],
            [1.960000000000000000e+02, 9.450000000000000000e+02],
            [1.970000000000000000e+02, 1.595000000000000000e+03],
            [1.980000000000000000e+02, 2.941000000000000000e+03],
            [1.990000000000000000e+02, 5.194000000000000000e+03],
            [2.000000000000000000e+02, 8.303000000000000000e+03],
            [2.010000000000000000e+02, 1.078800000000000000e+04],
            [2.020000000000000000e+02, 1.055300000000000000e+04],
            [2.030000000000000000e+02, 8.227000000000000000e+03],
            [2.040000000000000000e+02, 7.890000000000000000e+03],
            [2.050000000000000000e+02, 8.379000000000000000e+03],
            [2.060000000000000000e+02, 8.597000000000000000e+03],
            [2.070000000000000000e+02, 8.889000000000000000e+03],
            [2.080000000000000000e+02, 9.564000000000000000e+03],
            [2.090000000000000000e+02, 9.592000000000000000e+03],
            [2.100000000000000000e+02, 1.075600000000000000e+04],
            [2.110000000000000000e+02, 1.172800000000000000e+04],
            [2.120000000000000000e+02, 1.055200000000000000e+04],
            [2.130000000000000000e+02, 9.735000000000000000e+03],
            [2.140000000000000000e+02, 9.496000000000000000e+03],
            [2.150000000000000000e+02, 8.577000000000000000e+03],
            [2.160000000000000000e+02, 5.853000000000000000e+03],
            [2.170000000000000000e+02, 3.548000000000000000e+03],
            [2.180000000000000000e+02, 2.100000000000000000e+03],
            [2.190000000000000000e+02, 1.331000000000000000e+03],
            [2.200000000000000000e+02, 1.048000000000000000e+03],
            [2.210000000000000000e+02, 1.691000000000000000e+03],
            [2.220000000000000000e+02, 3.108000000000000000e+03],
            [2.230000000000000000e+02, 5.073000000000000000e+03],
            [2.240000000000000000e+02, 8.000000000000000000e+03],
            [2.250000000000000000e+02, 1.053100000000000000e+04],
            [2.260000000000000000e+02, 1.154500000000000000e+04],
            [2.270000000000000000e+02, 9.179000000000000000e+03],
            [2.280000000000000000e+02, 8.640000000000000000e+03],
            [2.290000000000000000e+02, 8.676000000000000000e+03],
            [2.300000000000000000e+02, 8.719000000000000000e+03],
            [2.310000000000000000e+02, 8.755000000000000000e+03],
            [2.320000000000000000e+02, 9.227000000000000000e+03],
            [2.330000000000000000e+02, 9.615000000000000000e+03],
            [2.340000000000000000e+02, 1.111600000000000000e+04],
            [2.350000000000000000e+02, 1.234400000000000000e+04],
            [2.360000000000000000e+02, 1.149500000000000000e+04],
            [2.370000000000000000e+02, 1.005000000000000000e+04],
            [2.380000000000000000e+02, 9.737000000000000000e+03],
            [2.390000000000000000e+02, 8.644000000000000000e+03],
            [2.400000000000000000e+02, 6.355000000000000000e+03],
            [2.410000000000000000e+02, 4.034000000000000000e+03],
            [2.420000000000000000e+02, 2.445000000000000000e+03],
            [2.430000000000000000e+02, 1.625000000000000000e+03],
            [2.440000000000000000e+02, 1.305000000000000000e+03],
            [2.450000000000000000e+02, 1.959000000000000000e+03],
            [2.460000000000000000e+02, 3.337000000000000000e+03],
            [2.470000000000000000e+02, 5.418000000000000000e+03],
            [2.480000000000000000e+02, 8.816000000000000000e+03],
            [2.490000000000000000e+02, 1.210100000000000000e+04],
            [2.500000000000000000e+02, 1.223400000000000000e+04],
            [2.510000000000000000e+02, 1.003900000000000000e+04],
            [2.520000000000000000e+02, 9.808000000000000000e+03],
            [2.530000000000000000e+02, 9.886000000000000000e+03],
            [2.540000000000000000e+02, 1.001000000000000000e+04],
            [2.550000000000000000e+02, 1.025500000000000000e+04],
            [2.560000000000000000e+02, 1.088000000000000000e+04],
            [2.570000000000000000e+02, 1.126900000000000000e+04],
            [2.580000000000000000e+02, 1.290800000000000000e+04],
            [2.590000000000000000e+02, 1.414000000000000000e+04],
            [2.600000000000000000e+02, 1.297400000000000000e+04],
            [2.610000000000000000e+02, 1.188900000000000000e+04],
            [2.620000000000000000e+02, 1.153300000000000000e+04],
            [2.630000000000000000e+02, 1.066400000000000000e+04],
            [2.640000000000000000e+02, 7.941000000000000000e+03],
            [2.650000000000000000e+02, 5.433000000000000000e+03],
            [2.660000000000000000e+02, 3.451000000000000000e+03],
            [2.670000000000000000e+02, 2.320000000000000000e+03],
            [2.680000000000000000e+02, 1.640000000000000000e+03],
            [2.690000000000000000e+02, 2.158000000000000000e+03],
            [2.700000000000000000e+02, 3.364000000000000000e+03],
            [2.710000000000000000e+02, 5.278000000000000000e+03],
            [2.720000000000000000e+02, 8.277000000000000000e+03],
            [2.730000000000000000e+02, 1.113300000000000000e+04],
            [2.740000000000000000e+02, 1.079700000000000000e+04],
            [2.750000000000000000e+02, 9.600000000000000000e+03],
            [2.760000000000000000e+02, 9.302000000000000000e+03],
            [2.770000000000000000e+02, 9.675000000000000000e+03],
            [2.780000000000000000e+02, 9.993000000000000000e+03],
            [2.790000000000000000e+02, 1.053600000000000000e+04],
            [2.800000000000000000e+02, 1.131200000000000000e+04],
            [2.810000000000000000e+02, 1.265000000000000000e+04],
            [2.820000000000000000e+02, 1.511500000000000000e+04],
            [2.830000000000000000e+02, 1.739300000000000000e+04],
            [2.840000000000000000e+02, 1.758700000000000000e+04],
            [2.850000000000000000e+02, 1.585000000000000000e+04],
            [2.860000000000000000e+02, 1.529500000000000000e+04],
            [2.870000000000000000e+02, 1.592500000000000000e+04],
            [2.880000000000000000e+02, 1.526100000000000000e+04],
            [2.890000000000000000e+02, 1.228500000000000000e+04],
            [2.900000000000000000e+02, 9.570000000000000000e+03],
            [2.910000000000000000e+02, 6.164000000000000000e+03],
            [2.920000000000000000e+02, 3.779000000000000000e+03],
            [2.930000000000000000e+02, 2.652000000000000000e+03],
            [2.940000000000000000e+02, 2.524000000000000000e+03],
            [2.950000000000000000e+02, 3.576000000000000000e+03],
            [2.960000000000000000e+02, 4.873000000000000000e+03],
            [2.970000000000000000e+02, 6.703000000000000000e+03],
            [2.980000000000000000e+02, 8.353000000000000000e+03],
            [2.990000000000000000e+02, 1.006300000000000000e+04],
            [3.000000000000000000e+02, 1.066600000000000000e+04],
            [3.010000000000000000e+02, 1.147400000000000000e+04],
            [3.020000000000000000e+02, 1.167200000000000000e+04],
            [3.030000000000000000e+02, 1.264200000000000000e+04],
            [3.040000000000000000e+02, 1.314800000000000000e+04],
            [3.050000000000000000e+02, 1.421500000000000000e+04],
            [3.060000000000000000e+02, 1.598200000000000000e+04],
            [3.070000000000000000e+02, 1.831300000000000000e+04],
            [3.080000000000000000e+02, 1.840500000000000000e+04],
            [3.090000000000000000e+02, 1.756200000000000000e+04],
            [3.100000000000000000e+02, 1.730100000000000000e+04],
            [3.110000000000000000e+02, 1.800200000000000000e+04],
            [3.120000000000000000e+02, 1.733000000000000000e+04],
            [3.130000000000000000e+02, 1.568800000000000000e+04],
            [3.140000000000000000e+02, 1.202700000000000000e+04],
            [3.150000000000000000e+02, 8.249000000000000000e+03],
            [3.160000000000000000e+02, 5.146000000000000000e+03],
            [3.170000000000000000e+02, 3.425000000000000000e+03],
            [3.180000000000000000e+02, 2.942000000000000000e+03],
            [3.190000000000000000e+02, 3.610000000000000000e+03],
            [3.200000000000000000e+02, 3.995000000000000000e+03],
            [3.210000000000000000e+02, 4.930000000000000000e+03],
            [3.220000000000000000e+02, 6.479000000000000000e+03],
            [3.230000000000000000e+02, 8.543000000000000000e+03],
            [3.240000000000000000e+02, 9.211000000000000000e+03],
            [3.250000000000000000e+02, 9.623000000000000000e+03],
            [3.260000000000000000e+02, 9.900000000000000000e+03],
            [3.270000000000000000e+02, 1.010500000000000000e+04],
            [3.280000000000000000e+02, 1.026400000000000000e+04],
            [3.290000000000000000e+02, 1.018900000000000000e+04],
            [3.300000000000000000e+02, 1.014300000000000000e+04],
            [3.310000000000000000e+02, 1.035400000000000000e+04],
            [3.320000000000000000e+02, 9.615000000000000000e+03],
            [3.330000000000000000e+02, 9.808000000000000000e+03],
            [3.340000000000000000e+02, 8.614000000000000000e+03],
            [3.350000000000000000e+02, 7.691000000000000000e+03],
            [3.360000000000000000e+02, 5.810000000000000000e+03]
        ];

        // Add button controls for time series chart
        // document.getElementById('zoomIn').addEventListener('click', function() {
        //     timeSeriesChart.zoom(1.1);
        // });

        // document.getElementById('zoomOut').addEventListener('click', function() {
        //     timeSeriesChart.zoom(0.9);
        // });

        // document.getElementById('panLeft').addEventListener('click', function() {
        //     timeSeriesChart.pan({
        //         x: -50
        //     }, undefined, 'default');
        // });

        // document.getElementById('panRight').addEventListener('click', function() {
        //     timeSeriesChart.pan({
        //         x: 50
        //     }, undefined, 'default');
        // });

        // document.getElementById('resetZoom').addEventListener('click', function() {
        //     timeSeriesChart.resetZoom();
        // });

        // Prepare data for Chart.js
        const labels = timeSeriesData.map(item => item[0]);
        const dataPoints = timeSeriesData.map(item => item[1]);

        // Create time series chart
        const timeSeriesCtx = document.getElementById('timeSeriesChart').getContext('2d');
        const timeSeriesChart = new Chart(timeSeriesCtx, {
            type: 'line',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Chicago Ridesharing Trips',
                    data: dataPoints,
                    borderColor: 'rgb(75, 192, 192)',
                    tension: 0.1,
                    pointRadius: 0,
                    borderWidth: 2.5
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Time (hour)'
                        },
                        ticks: {
                            stepSize: 24,
                            callback: function(value) {
                                return value % 24 === 0 ? value : '';
                            },
                            autoSkip: false,
                            maxRotation: 0,
                            minRotation: 0
                        },
                        grid: {
                            color: function(context) {
                                return context.tick.value % 24 === 0 ? 
                                    'rgba(0, 0, 0, 0.1)' : 
                                    'rgba(0, 0, 0, 0.05)';
                            },
                            lineWidth: function(context) {
                                return context.tick.value % 24 === 0 ? 2 : 1;
                            }
                        }
                    },
                    y: {
                        title: {
                            display: true,
                            text: 'Trip count'
                        }
                    }
                },
                plugins: {
                    zoom: {
                        zoom: {
                            wheel: {
                                enabled: true,
                            },
                            pinch: {
                                enabled: true
                            },
                            mode: 'xy',
                        },
                        pan: {
                            enabled: true,
                            mode: 'xy',
                        }
                    }
                }
            }
        });

        // Extract values from time series data
        const values = timeSeriesData.map(item => item[1]);
        const maxValue = Math.max(...values);
        
        // Create scatter plot data for a given lag
        function createScatterData(lag) {
            const scatterData = [];
            for (let i = lag; i < values.length; i++) {
                scatterData.push({
                    x: values[i - lag],
                    y: values[i]
                });
            }
            return scatterData;
        }

        // Create y=x line data
        function createDiagonalData() {
            return [
                {x: 0, y: 0},
                {x: maxValue, y: maxValue}
            ];
        }

        // Initialize scatter charts
        const scatterCharts = [];
        const initialLags = [1, 24, 168];
        
        for (let i = 0; i < 3; i++) {
            const ctx = document.getElementById(`scatterChart${i+1}`).getContext('2d');
            const chart = new Chart(ctx, {
                type: 'scatter',
                data: {
                    datasets: [
                        {
                            label: `Time series at t vs. t-${initialLags[i]}`,
                            data: createScatterData(initialLags[i]),
                            backgroundColor: 'rgba(75, 192, 192, 0.5)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1,
                            pointRadius: 3
                        },
                        {
                            label: 'y = x',
                            data: createDiagonalData(),
                            type: 'line',
                            borderColor: 'rgba(128, 128, 128, 1)',
                            borderWidth: 1,
                            pointRadius: 0,
                            fill: false,
                            showLine: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    aspectRatio: 1, // Makes the chart square
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: `Trip count at t-${initialLags[i]}`
                            },
                            min: 0,
                            max: maxValue
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Trip count at t'
                            },
                            min: 0,
                            max: maxValue
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `(${context.parsed.x}, ${context.parsed.y})`;
                                }
                            }
                        }
                    }
                }
            });
            scatterCharts.push(chart);
        }

        // Update scatter chart with new lag value
        function updateChart(chartIndex) {
            const lagInput = document.getElementById(`lag${chartIndex}`);
            const lag = parseInt(lagInput.value);
            
            if (lag < 1 || lag > 360) {
                alert('Please enter a lag value between 1 and 360');
                return;
            }
            
            const chart = scatterCharts[chartIndex-1];
            chart.data.datasets[0].data = createScatterData(lag);
            chart.data.datasets[0].label = `Time series at t vs. t-${lag}`;
            chart.options.scales.x.title.text = `Trip count at t-${lag}`;
            chart.update();
        }
    </script>
</body>
</html>
